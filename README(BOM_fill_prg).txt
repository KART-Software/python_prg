BOM_fill_prg
(ver. Python 3.8.4)

FCAからQuantity, Materia Costl, Process Cost, Fastener Cost, Tooling Costを読み取り，BOMを埋めます．
また，各FCAのシートへのリンクを生成します．

## Description
2020年度の電子提出版コストレポートのディレクトリ構造に合わせて作成したBOM作成プログラムです．
Python3.8.4, Openpyxl3.03にて動作します．
実行すると以下の入力が求められます．
・最上階層のフォルダ名：FCAとBOMがまとめて入っているフォルダです
・BOMのファイル名(拡張子を含む)
・車番(半角三桁)
・章番号
・BOMファイル内で指定のシステムアセンブリが記入される行番号の最小値と最大値
これらを入力すると，BOMの空欄が埋められます．
実行時には確認用に処理が行われたComponent名が全て表示されます．

##VS. ExcelTracerforCost
本プログラムはコードを簡潔に書くことで，可読性を向上し，メンテナンスを行いやすくすることを重視しています．
そのため，フォーマットの変更時，ディレクトリの構造変更時などは，修正が必要となる可能性が高いです．
修正が不能な場合はExcelTracerforCostを使用してください．
また，Component名にスペースが含まれる際に読み取ることができない問題点を修正しました．
正しく埋まらない場合は，Component名がBOMとFCAで完全に異なる場合があります．
さらに，HYPERLINK関数によるリンクを生成する機能を追加しました．

## Requirement
・Python3の導入が必須です
・外部ライブラリopenpyxlを使用しています．導入が必須です．
　コマンドプロンプトを起動し，"pip install openpyxl"と入力するだけでインストールできます．

##Usage
python_prgのフォルダごと，コストレポートの最上階層と同じ階層にコピーしてください．
example)
--------015_KyotoUniversity_FSAEJ_CR---------015_A1_BR
 　|                                                         |-----015_A2_EN
　 |                                                         |-----015_A3_FR
    |                                                         |            ：
　 |　　　　　　　　　　　　　　　　　　　　　   |-----015_KyotoUniversity_FSAEJ_CR_BOM.xlsx
　 |
    |---python_prg-------------------------------------BOM_fill_prg.py
                                                               |------README(BOM_fill_prg).txt

次にIDLEを起動し，File→OpenからBOM_fill_prg.pyを開いてください．
(プログラムを動かすのみであればパワーシェルから開いても可能ですが，コードの修正はできません)
最後に，F5キーを押すと実行されます．

## Attention
・最初に入力した内容以外は2020年度フォーマットに対して動作します．
　フォーマットの変更によるFCAのsub_totalの列の変更，BOMの空欄部の列の変更などで動作しなくなります．
　ただし，フォーマットの多少の変更であれば，コードを数文字修正するのみで正しく動作します．
　各コードで何を行っているかは#にてコード中に注釈してあるので，修正してみてください．
・ディレクトリ構造はフォルダ名以外は2020年度の構造(以下)を厳密に維持してください．
　最上階層→BOMと各システムアセンブリのFCAおよび裏付け資料を含むフォルダ→サブシステムのフォルダ→FCAと裏付け資料
　システムアセンブリのフォルダ名を入力すると，そのフォルダ内に含まれるサブシステムのフォルダを全てリスト化します．
　さらにリスト内のサブシステムフォルダに存在する拡張子が.xlsxのファイルを順に全て開いて読み取っていきます．
　このため，フォルダ内にFCA以外のExcelファイルが存在すると誤作動が起きる場合があります．
　(ただし，シート名がBOMのComponent名と一致しない場合は無視するようにコードされてはいます．)
・openpyxlは拡張子が.xlsxのファイルしか読み取ることができません．
　マクロが組み込まれたExcelファイルは取り扱うことができません．
 (そもそも.xlsx形式以外での提出は認められていません)
・HYPERLINK関数に関しては2020年度のフォルダ，ファイル命名法においてのみ正しくリンクが生成されます．
　ただし，この部分のコードは少し修正するだけで，正しいリンクを生成できるようになっています．
　(str型で各データを加算して，セルに入る関数を文字列として生成ているだけです)
・アセンブリが複数セットある場合，読み取って来るParts_FCAのQuantityにアセンブリのセット数を乗算する必要があると考え，そのコードを加えています．
 不要な場合はコードに'#'をつけて無効化してください．
・FCA内のsub_totalを検索する方法は，FCA内のB列からMaterialなどの文字列を検索し，そこから下のセルを順に見ていきます．
  そして，空白セルに達した時点で，その行の特定の列のセルをsub_totalとして読み取っています．
　最後に読み取った値を，BOM内のシート名に一致するComponentの行の特定の列に入れています．
　(関数の実引数の変更のみで，検索する文字列，sub_totalを含む列，値を入れるBOMの列を変更することができます)
・本プログラムではget_sheet_names関数を使用しています．verの更新でこの関数が削除される可能性があります．

## Update
修正・改良したらここにログを書き込みましょう．

## Author
野口晴臣
080-7826-1613
医学部医学科4回生(2020年度)