FCA2pdf
(ver. Python 3.8.4)

システムアセンブリ内の全てのFCAからPDFを出力するプログラムです．
※作成者が個人的な趣味で組んだプログラムです．
　2020年度の階層構造では動きますが，他年度の階層構造で動く保証はありません．
　動かない場合は，PDF編集ソフトを使った方が速いかと思います．
　一応，型番のチェックはしてくれますし，10分程度の節約はできるので，使ってみてもいいかもしれません．

## Description
2020年度の電子提出版コストレポートのディレクトリ構造に合わせて作成したFCAのPDF出力プログラムです．
Python3.8.4, Openpyxl3.03, PyPDF2 1.26.0, win32com 227にて動作を確認しています．
実行すると以下の入力が求められます．
・最上階層のフォルダ名：FCAとBOMがまとめて入っているフォルダです
・実行するシステムアセンブリのフォルダ名
これらを入力すると，"FCA統合(名前を変更).pdf "が出力されます．
実行時にはP/N Baseに誤りがあると考えられるパーツ名が全て表示されます．

## Requirement
・Python3の導入が必須です
・外部ライブラリopenpyxl, PyPDF2, win32comを使用しています．導入が必須です．
　コマンドプロンプトを起動し，"pip install openpyxl", "pip install PyPDF2"と入力するだけでインストールできます．
  win32comのインストール法はググってください．

##Usage
python_prgのフォルダごと，コストレポートの最上階層と同じ階層にコピーしてください．
example)
--------015_KyotoUniversity_FSAEJ_CR---------015_A1_BR
 　|                                                         |-----015_A2_EN
　 |                                                         |-----015_A3_FR
    |                                                         |            ：
　 |　　　　　　　　　　　　　　　　　　　　　   |-----015_KyotoUniversity_FSAEJ_CR_BOM.xlsx
　 |
    |---python_prg-------------------------------------FCA2pdf.py
                                                               |------README(FCA2pdf).txt

次にIDLEを起動し，File→OpenからFCA2pdf.pyを開いてください．
(プログラムを動かすのみであればパワーシェルから開いても可能ですが，コードの修正はできません)
最後に，F5キーを押すと実行されます．

## Attention
・最初に入力した内容以外は2020年度フォーマットに対して動作します．
　FCAの型番のセルに変更があると動作しなくなります．
・ディレクトリ構造はフォルダ名以外は2020年度の構造(以下)を厳密に維持してください．
　最上階層→BOMと各システムアセンブリのFCAおよび裏付け資料を含むフォルダ→サブシステムのフォルダ→FCAと裏付け資料
　システムアセンブリのフォルダ名を入力すると，そのフォルダ内に含まれるサブシステムのフォルダを全てリスト化します．
　さらにリスト内のサブシステムフォルダに存在する拡張子が.xlsxのファイルを順に全て開いて読み取っていきます．
　このため，フォルダ内にFCA以外のExcelファイルが存在すると誤作動が起きます．
・openpyxlは拡張子が.xlsxのファイルしか読み取ることができません．
　マクロが組み込まれたExcelファイルは取り扱うことができません．
 (そもそも.xlsx形式以外での提出は認められていません)
・エラーにより，ページが重複するバグが確認されています．
　出力後に確認してください．
・プログラムの機能を削除・追加しやすいように多少冗長なコードの書き方をしています．
　改良したくなったら，書き換えてもらって構いませんが，完了までの時間はさほど変化しません．

## Update
修正・改良したらここにログを書き込みましょう．

## Author
野口晴臣
080-7826-1613
医学部医学科4回生(2020年度)